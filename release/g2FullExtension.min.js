/**
 * g2.core (c) 2013-22 Stefan Goessner
 * @author Stefan Goessner
 * @license MIT License
 * @link https://github.com/goessner/g2
 * @typedef {g2}
 * @param {object} [opts] Custom options object.
 * @description Create a 2D graphics command queue object. Call without using 'new'.
 * @returns {g2}
 * @example
 * const ctx = document.getElementById("c").getContext("2d");
 * g2()                                   // Create 'g2' instance.
 *     .lin({x1:50,y1:50,x2:100,y2:100})  // Append ...
 *     .lin({x1:100,y1:100,x2:200,y2:50}) // ... commands.
 *     .exe(ctx);                         // Execute commands addressing canvas context.
 */
"use strict";function g2(t){let e=Object.create(g2.prototype);e.commands=[];if(t)Object.assign(e,t);return e}g2.prototype={addCommand({c:t,a:e}){if(e&&Object.getPrototypeOf(e)===Object.prototype){for(const s in e){if(!Object.getOwnPropertyDescriptor(e,s).get&&s[0]!=="_"&&typeof e[s]==="function"){Object.defineProperty(e,s,{get:e[s],enumerable:true,configurable:true,writabel:false})}if(typeof e[s]==="string"&&e[s][0]==="@"){const i=e[s].indexOf(".");const n=i>0?e[s].substr(1,i-1):"";const r=n?e[s].substr(i+1):"";const o=n?()=>this.commands.find(t=>t.a&&t.a.id===n):undefined;if(o)Object.defineProperty(e,s,{get:function(){const t=o();return t&&r in t.a?t.a[r]:0},enumerable:true,configurable:true,writabel:false})}}if(g2.prototype[t].prototype)Object.setPrototypeOf(e,g2.prototype[t].prototype)}this.commands.push(arguments[0]);return this},arc({x:t,y:e,r:s,w:i,dw:n}){return this.addCommand({c:"arc",a:arguments[0]})},beg({x:t,y:e,w:s,scl:i,matrix:n}={}){return this.addCommand({c:"beg",a:arguments[0]})},box({x:t=0,y:e=0,w:s=0,b:i,h:n}){return this.addCommand({c:"box",a:arguments[0]})},cir({x:t,y:e,r:s,w:i}){return this.addCommand({c:"cir",a:arguments[0]})},clr(){return this.addCommand({c:"clr"})},del(t){this.commands.length=t||0;return this},ell({x:t,y:e,rx:s,ry:i,w:n,dw:r,rot:o}){return this.addCommand({c:"ell",a:arguments[0]})},end(){let t=1,e,s;for(e=this.commands.length-1;e>=0;e--){s=this.commands[e];if(s.c==="beg")t--;else if(s.c==="end")t++;if(t===0)break}return t===0?this.addCommand({c:"end"}):this},exe(t){const e=g2.handler(t);if(e&&e.init(this)){if(e.exe)e.exe(this.commands);else this.exeCommands(e,this.commands,this.view)}return this},async exeCommands(t,e,s){if(e)for(const i of e){if(i.c&&t[i.c]){const n=t[i.c](i.a);if(n&&n instanceof Promise)await n}if(i.a?.g2_arr){for(const r of i.a.g2_arr)this.exeCommands(t,r.bind(i.a)(s)?.commands,s)}else if(i.a?.g2){this.exeCommands(t,i.a.g2(s)?.commands,s)}if(i.g2)this.exeCommands(t,i.g2.commands,s)}return this},grid({color:t,size:e}={}){return this.addCommand({c:"grid",a:arguments[0]})},img({uri:t,x:e,y:s,b:i,h:n,sx:r,sy:o,sb:a,sh:l,xoff:c,yoff:h,w:y,scl:f}){return this.addCommand({c:"img",a:arguments[0]})},ins(t){return typeof t==="function"?t(this)||this:typeof t==="object"&&t instanceof g2?this.addCommand({c:"ins",g2:t}):this},lin({x1:t,y1:e,x2:s,y2:i}){return this.addCommand({c:"lin",a:arguments[0]})},path(t){return this.addCommand({c:"path",a:t})},ply({pts:t,format:e,closed:s,x:i,y:n,w:r}){arguments[0].pts=g2.poly.proxy(arguments[0].pts,i,n,r);return this.addCommand({c:"ply",a:arguments[0]})},rec({x:t,y:e,b:s,h:i}){return this.addCommand({c:"rec",a:arguments[0]})},txt({str:t,x:e,y:s,w:i}){return this.addCommand({c:"txt",a:arguments[0]})},use({grp:t,x:e,y:s,w:i,scl:n}){if(t&&t!==this){const r=t instanceof g2?t:typeof t==="string"&&t in g2.symbol?g2.symbol[t]:g2.symbol["unknown"];const o={c:"use",a:arguments[0],g2:g2().beg(arguments[0]).ins(r).end()};this.addCommand(o)}return this},view({scl:t,x:e,y:s,cartesian:i}){return this.addCommand({c:"view",a:this.view=arguments[0]})}};g2.defaultStyle={fs:"transparent",ls:"#000",lw:1,lc:"butt",lj:"miter",ld:[],ml:10,sh:[0,0],lsh:false,font:"16px serif",thal:"start",tval:"alphabetic"};g2.styleRex=/^(fs|ls|lw|lc|lj|ld|ldoff|ml|sh|lsh|font|thal|tval)([-0-9].*)?$/,g2.symbol={unknown:g2().cir({r:12,fs:"orange"}).txt({str:"?",thal:"center",tval:"middle",font:"bold 20pt serif"})};g2.handler=function(e){let s;for(let t of g2.handler.factory)if((s=t(e))!==false)return s;return false};g2.handler.factory=[];g2.mixin=function t(...e){const s={g2_arr:[]};for(const i of e){if(i){Object.defineProperties(s,Object.getOwnPropertyDescriptors(i));if("g2"in i){i.g2.level=i.g2_level||0;s.g2_arr.push(i.g2)}}}if("g2"in s){delete s.g2;s.g2_arr.sort((t,e)=>t.level-e.level)}return s};g2.poly=globalThis.poly2||{};g2.poly.proxy=g2.poly.proxy||function(t,e,s,i){if(Array.isArray(t)&&t.length>1){const n=typeof t[0]==="number"?poly2.proxy.flat(t):Array.isArray(t[0])&&typeof t[0][0]==="number"&&t[0].length>=2?g2.poly.proxy.arr(t):t;return e||s||i?g2.poly.proxy.trf(n,{x:e,y:s,w:i}):n}};g2.poly.proxy.flat=g2.poly.proxy.flat||function(e){const s=new Array(~~(e.length/2));s[Symbol.iterator]=function(){let t=0;return{next(){return t<s.length?{value:{x:e[t*2],y:e[t++*2+1]},done:false}:{done:true}}}};return new Proxy(e,{get:(t,e)=>{if(e===Symbol.iterator)return s[Symbol.iterator].bind(s);else if(!isNaN(+e))return{x:t[e*2],y:t[e*2+1]};else if(e==="length")return~~(t.length/2);else return t[e]}})};g2.poly.proxy.arr=g2.poly.proxy.arr||function(e){const s=new Array(e.length);s[Symbol.iterator]=function(){let t=0;return{next(){return t<s.length?{value:{x:e[t][0],y:e[t++][1]},done:false}:{done:true}}}};return new Proxy(e,{get:(t,e)=>{if(e===Symbol.iterator)return s[Symbol.iterator].bind(s);else if(!isNaN(+e))return{x:t[e][0],y:t[e][1]};else return t[e]}})};g2.poly.proxy.trf=g2.poly.proxy.trf||function(s,{w:t=0,x:i=0,y:n=0}){if(t||i||n){const r=new Array(s.length);const o=Math.sin(t),a=Math.cos(t);r[Symbol.iterator]=function(){let e=0;return{next(){if(e<r.length){const t=s[e++];return{value:{x:t.x*a-t.y*o+i,y:t.x*o+t.y*a+n},done:false}}return{done:true}}}};return new Proxy(s,{get:(t,e)=>{if(e===Symbol.iterator)return r[Symbol.iterator].bind(r);else if(!isNaN(+e)){const s=t[+e];return{x:s.x*a-s.y*o+i,y:s.x*o+s.y*a+n}}else return t[e]}})}return s};g2.prototype.p=function(){return this.addCommand({c:"p"})},g2.prototype.z=function(){return this.addCommand({c:"z"})},g2.prototype.m=function({x:t,y:e}){return this.addCommand({c:"m",a:arguments[0]})},g2.prototype.l=function({x:t,y:e}){return this.addCommand({c:"l",a:arguments[0]})},g2.prototype.q=function({x1:t,y1:e,x:s,y:i}){return this.addCommand({c:"q",a:arguments[0]})},g2.prototype.c=function({x1:t,y1:e,x2:s,y2:i,x:n,y:r}){return this.addCommand({c:"c",a:arguments[0]})},g2.prototype.a=function({dw:t,x:e,y:s}){const i=this.commands[this.commands.length-1];g2.cpyProp(i.a,"x",arguments[0],"_xp");g2.cpyProp(i.a,"y",arguments[0],"_yp");return this.addCommand({c:"a",a:arguments[0]})},g2.prototype.stroke=function({d:t}={}){return this.addCommand({c:"stroke",a:arguments[0]})},g2.prototype.fill=function({d:t}={}){return this.addCommand({c:"fill",a:arguments[0]})},g2.prototype.drw=function({d:t,lsh:e}={}){return this.addCommand({c:"drw",a:arguments[0]})},g2.cmdIdxBy=function(e,s){for(let t=e.length-1;t>=0;t--)if(s(e[t],t,e))return t;return false};g2.cpyProp=function(t,e,s,i,n=0){const r=Object.getOwnPropertyDescriptor(t,e)||{value:n,writable:true,enumerable:true,configurable:true};Object.defineProperty(s,i,r)};g2.pntIterator={"x,y":function(e){function t(t){return{x:e[2*t],y:e[2*t+1]}}Object.defineProperty(t,"len",{get:()=>e.length/2,enumerable:true,configurable:true,writabel:false});return t},"[x,y]":function(e){function t(t){return e[t]?{x:e[t][0],y:e[t][1]}:undefined}Object.defineProperty(t,"len",{get:()=>e.length,enumerable:true,configurable:true,writabel:false});return t},"{x,y}":function(e){function t(t){return e[t]}Object.defineProperty(t,"len",{get:()=>e.length,enumerable:true,configurable:true,writabel:false});return t}};g2.pntItrOf=function(t){return!(t&&t.length)?undefined:typeof t[0]==="number"?g2.pntIterator["x,y"](t):Array.isArray(t[0])&&t[0].length>=2?g2.pntIterator["[x,y]"](t):typeof t[0]==="object"&&"x"in t[0]&&"y"in t[0]?g2.pntIterator["{x,y}"](t):undefined};
/**
 * g2.ext (c) 2015-22 Stefan Goessner
 * @author Stefan Goessner
 * @license MIT License
 * @requires g2.core.js
 * @typedef {g2}
 * @description Advanced symbols and prototypes for g2.
 * @returns {g2}
 */"use strict";g2.NONE=0;g2.OVER=1;g2.DRAG=2;g2.EDIT=4;g2.ifc={};g2.ifc.point={get x(){return Object.getOwnPropertyDescriptor(this,"p")?this.p.x:0},set x(t){if(Object.getOwnPropertyDescriptor(this,"p"))this.p.x=t},get y(){return Object.getOwnPropertyDescriptor(this,"p")?this.p.y:0},set y(t){if(Object.getOwnPropertyDescriptor(this,"p"))this.p.y=t},drag({x:t,y:e}){this.x=t;this.y=e}};g2.ifc.line={get x1(){return Object.getOwnPropertyDescriptor(this,"p1")?this.p1.x:0},get y1(){return Object.getOwnPropertyDescriptor(this,"p1")?this.p1.y:0},get x2(){return Object.getOwnPropertyDescriptor(this,"p2")?this.p2.x:0},get y2(){return Object.getOwnPropertyDescriptor(this,"p2")?this.p2.y:0},get len(){return Math.hypot(this.x2-this.x1,this.y2-this.y1)},pointAt(t){const e=t==="beg"?0:t==="end"?1:t+0===t?t:.5;const s=this.x2-this.x1;const i=this.y2-this.y1;const n=Math.hypot(s,i);return{x:this.x1+s*e,y:this.y1+i*e,nx:n?i/n:0,ny:n?-s/n:-1}},hit({x:t,y:e,eps:s}){const{x1:i,y1:n,x2:r,y2:o}=this;const a=r-i,l=o-n,c=t-i,h=e-n;const y=a*c+l*h,f=a*h-l*c,g=Math.hypot(a,l),d=s*g;return-d<f&&f<d&&-d<y&&y<g*(g+s)},drag({dx:t,dy:e}){this.x1+=t;this.x2+=t;this.y1+=e;this.y2+=e}};g2.ifc.arc={pointAt(t){const e=t==="beg"?0:t==="end"?1:t+0===t?t:.5;const s=(this.w||0)+e*(this.dw||Math.PI*2);const i=Math.cos(s),n=Math.sin(s);const r=t==="c"?0:this.r;return{x:this.x+r*i,y:this.y+r*n,nx:i,ny:n}},asPoly(){const{x:e,y:s,r:i}=this;const t=Math.floor(this.dw*i/(4*(this.lw||1)));const n=this.dw/t;const r=[];for(let t=this.w;t<this.dw-n;t+=n)r.push({x:e+i*Math.cos(t),y:s+i*Math.sin(t)});return r}};g2.ifc.circular={get isSolid(){return this.fs&&this.fs!=="transparent"},get len(){return 2*Math.PI*this.r},get lsh(){return this.state&g2.OVER},get sh(){return this.state&g2.OVER?[0,0,5,"black"]:false},pointAt(t,e){const s=Math.SQRT2/2;const i={c:[0,0],e:[1,0],ne:[s,s],n:[0,1],nw:[-s,s],w:[-1,0],sw:[-s,-s],s:[0,-1],se:[s,-s]};const n=t+0===t?[Math.cos(t*2*Math.PI),Math.sin(t*2*Math.PI)]:i[t||"c"]||[0,0];if(!e)n[1]=-n[1];return{x:this.x+n[0]*this.r,y:this.y+n[1]*this.r,nx:n[0],ny:n[1]}},asPoly(){const{x:e,y:s,r:i}=this;const t=Math.max(Math.floor(2*Math.PI*i/(4*(this.lw||1))),5);const n=2*Math.PI/t;const r=[];for(let t=0;t<2*Math.PI-n;t+=n)r.push({x:e+i*Math.cos(t),y:s+i*Math.sin(t)});return r},hit({x:t,y:e,eps:s}){return this.isSolid?this.isPntIn({x:t,y:e,eps:s}):this.isPntOn({x:t,y:e,eps:s})},isPntIn({x:t,y:e,eps:s}){return(this.x-t)**2+(this.y-e)**2<this.r**2},isPntOn({x:t,y:e,eps:s}){const i=(this.x-t)**2+(this.y-e)**2-this.r**2,n=s*this.r;return-n<i&&i<n}};g2.ifc.label={significantDigits:2,get offset(){const t=this.label.off!==undefined?+this.label.off:this.lboff||1;return t+Math.sign(t)*(this.lw||2)/2},valueFrom(t){const e=this[t];return isNaN(t)?e:Number.isInteger(e)?Number(e):Number(e).toFixed(Math.max(this.significantDigits-Math.log10(e),0))},get string(){const t=typeof this.label==="object"?this.label.str:typeof this.label==="string"?this.label:"?";return t.replace(/([^@]*)@([^;]+);?(.*)/g,(t,e,s,i)=>e+(s?this.valueFrom(s):"")+i)},g2_level:5,g2(t){const e=this.label;if(e){const s=e.font||g2.defaultStyle.font;const i=+s.replace(/.*?([0-9]+)px.*/g,(t,e)=>e);const n=this.string;const r=(n.length||1)*.65*i/2;const o=1.25*i/2;const a=this.pointAt(e.loc||this.lbloc,!!t.cartesian);const l=this.offset;const c={x:a.x+a.nx*(l+Math.sign(l)*r),y:a.y+a.ny*(l+Math.sign(l)*o)};const h=g2();if(e.border||e.fs){e.fs=e.border&&e.border.fs||(e.fs==="@"?this.fs:e.fs)||"#ffc";h.ell({x:c.x,y:c.y,rx:r,ry:o,ls:(e.border===true?this.ls:e.border?.ls||e.ls)||"transparent",fs:e.border?.fs||e.fs||"#ffc"})}h.txt({str:n,x:c.x,y:c.y,thal:"center",tval:"middle",fs:e.ls||this.ls||"black",font:s});return h}}};g2.ifc.hatch={g2_level:1,g2(){if(this.hatch&&this.asPoly){const t=g2();const e={w:Math.PI/4,dist:4*(this.lw||1),gap:3*(this.lw||1),lc:"round"};const s=this.hatch===true?e:{...e,...this.hatch};const{ls:i,lw:n,lc:r}={...this,...s};const o=poly2.hatch(s,this.asPoly());if(o.length>1){let e="";for(let t=0;t<o.length;t+=2)e+=`M${o[t].x},${o[t].y}L${o[t+1].x},${o[t+1].y}`;t.stroke({d:e,ls:i,lw:n,lc:r})}return t}}};g2.prototype.arc.prototype=g2.mixin(g2.ifc.point,g2.ifc.arc,g2.ifc.label,g2.ifc.hatch,{get angle(){return this.dw*180/Math.PI}});g2.prototype.box.prototype=g2.mixin(g2.ifc.label,g2.ifc.hatch,{x:0,y:0,w:0,asPoly(){const t=this.b/2,e=this.h/2;const s=[{x:-t,y:-e},{x:t,y:-e},{x:t,y:e},{x:-t,y:e}];return poly2.proxy.trf(s,{x,y,w}=this)},pointAt(t){const{x:e,y:s,b:i,h:n}=this;const r=Math.hypot(i,n),o=i/r,a=n/r;const l={c:[0,0,0,0],e:[i/2,0,1,0],ne:[i/2,n/2,o,a],n:[0,n/2,0,1],nw:[-i/2,n/2,-o,a],w:[-i/2,0,-1,0],sw:[-i/2,-n/2,-o,-a],s:[0,-n/2,0,-1],se:[i/2,-n/2,o,-a]};const c=l[t]||l["c"];if(this.w){const h=Math.cos(this.w),y=Math.sin(this.w);return{x:e+h*c[0]-y*c[1],y:s+y*c[0]+h*c[1],nx:h*c[2]-y*c[3],ny:y*c[2]+h*c[3]}}return{x:e+c[0],y:s+c[1],nx:c[2],ny:c[3]}}});g2.prototype.cir.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,g2.ifc.hatch);g2.prototype.lin.prototype=g2.mixin(g2.ifc.line,g2.ifc.label,{drag({dx:t,dy:e}){this.x1+=t;this.x2+=t;this.y1+=e;this.y2+=e}});g2.prototype.rec.prototype=g2.mixin(g2.ifc.label,g2.ifc.hatch,{asPoly(){const{x:t,y:e,b:s,h:i}=this;return[{x:t,y:e},{x:t+s,y:e},{x:t+s,y:e+i},{x:t,y:e+i}]},pointAt(t){const{b:e,h:s}=this;const i=Math.hypot(e,s),n=e/i,r=s/i;const o={c:[e/2,s/2,0,0],e:[e,s/2,1,0],ne:[e,s,n,r],n:[e/2,s,0,1],nw:[0,s,-n,r],w:[0,s/2,-1,0],sw:[0,0,-n,-r],s:[e/2,0,0,-1],se:[e,0,n,-r]};const a=o[t]||o["c"];return{x:this.x+a[0],y:this.y+a[1],nx:a[2],ny:a[3]}}});g2.prototype.hdl=function(t){return this.addCommand({c:"hdl",a:t})};g2.prototype.hdl.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,g2.ifc.hatch,{r:5,isSolid:true,draggable:true,lbloc:"se",get lsh(){return this.state&g2.OVER},get sh(){return this.state&g2.OVER?[0,0,5,"black"]:false},g2(){const{x:t,y:e,r:s,ls:i="black",fs:n="#ffc",sh:r}=this;return g2().cir({x:t,y:e,r:s,ls:i,fs:n,sh:r})}});g2.prototype.nod=function(t={}){return this.addCommand({c:"nod",a:t})};g2.prototype.nod.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,{r:5,lbloc:"se",g2(){const{x:t,y:e,r:s,ls:i=g2.symbol.nodcolor,fs:n=g2.symbol.nodfill}=this;return g2().cir({x:t,y:e,r:s,fs:n,ls:i})}});g2.prototype.dblnod=function({x:t=0,y:e=0}){return this.addCommand({c:"dblnod",a:arguments[0]})};g2.prototype.dblnod.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,{r:6,lbloc:"se",g2(){const{x:t,y:e,r:s,ls:i=g2.symbol.nodcolor,fs:n=g2.symbol.nodfill,fs_2:r=g2.symbol.nodfill2}=this;return g2().cir({x:t,y:e,r:s,ls:i,fs:n}).cir({x:t,y:e,r:s/2,ls:i,fs:r})}});g2.prototype.gnd=function({x:t,y:e,r:s}){return this.addCommand({c:"gnd",a:arguments[0]})};g2.prototype.gnd.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,{r:6,lbloc:"se",g2(t){const{x:e,y:s,r:i=4,ls:n=g2.symbol.nodcolor,fs:r=g2.symbol.nodfill}=this;const o=t.cartesian?1:-1;return g2().cir({x:e,y:s,r:i,ls:n,fs:r}).path({seg:[{c:"m",x:e,y:s+o*i},{c:"a",x:e-i,y:s,dw:o*Math.PI/2},{c:"l",x:e+i,y:s},{c:"a",x:e,y:s-o*i,dw:-o*Math.PI/2},{c:"z"}],ls:"transparent",fs:g2.symbol.nodcolor})}});g2.prototype.pol=function t({x:e,y:s,r:i}){return this.addCommand({c:"pol",a:arguments[0]})};g2.prototype.pol.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,{r:6,lbloc:"se",g2(t){const{x:e,y:s,r:i,ls:n=g2.symbol.nodcolor,fs:r=g2.symbol.nodfill}=this;return g2().cir({x:e,y:s,r:i,fs:r,ls:n}).cir({x:e,y:s,r:i*2/5,fs:n,ls:"transparent"})}});g2.prototype.slider=function({x:t,y:e,b:s,h:i,w:n,ls:r,fs:o,fs_2:a}){return this.addCommand({c:"slider",a:arguments[0]})};g2.prototype.slider.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,{b:32,h:16,r:5,w:0,lbloc:"se",lboff:4,g2(t){const{x:e,y:s,b:i,h:n,r,w:o,ls:a=g2.symbol.nodcolor,fs:l=g2.symbol.nodfill,fs_2:c="#fefefe99"}=this;return g2().box({x:e,y:s,w:o,b:i,h:n,fs:c}).cir({x:e,y:s,r:r,fs:l,ls:a})}});g2.prototype.link=function({pts:t,x:e,y:s,w:i}){return this.addCommand({c:"link",a:arguments[0]})};g2.prototype.link.prototype={x:0,y:0,w:0,closed:false,g2(t){const{pts:e,closed:s,x:i,y:n,w:r,ls:o="#666",fs:a="#fefefe66",lw:l=5,lc:c="round",lj:h="round"}=this;return g2().ply({pts:e,x:i,y:n,w:r,ls:o,fs:s?a:"transparent",lw:l,lc:c,lj:h})}};g2.prototype.yinyang=function t({x:e,y:s,r:i,ls:n,fs:r,lw:o}){return this.addCommand({c:"yinyang",a:arguments[0]})};g2.prototype.yinyang.prototype={r:12,g2(t){const e=Math.PI;const s=t.cartesian?-1:1;const{x:i,y:n,r,ls:o="#666",fs:a="#eee",lw:l=1}=this;return g2().beg({x:i,y:n,r:r,ls:o,fs:a,lw:l}).cir({r:r}).path({seg:[{c:"m",x:0,y:-s*r},{c:"a",x:0,y:0,dw:s*e},{c:"a",x:0,y:s*r,dw:-s*e},{c:"a",x:0,y:-s*r,dw:-s*e},{c:"z"}],fs:o}).cir({y:s*r/2,r:r/4}).cir({y:-s*r/2,r:r,r:r/4,ls:"transparent",fs:o}).end()}};g2.symbol=g2.symbol||{};g2.symbol.tick=g2().path({d:"M0,-2L0,2",lc:"round"});g2.symbol.dot=g2().cir({x:0,y:0,r:2,ls:"transparent"});g2.symbol.sqr=g2().rec({x:-1.5,y:-1.5,b:3,h:3,ls:"transparent"});g2.symbol.nodcolor="#333";g2.symbol.nodfill="#dedede";g2.symbol.nodfill2="#aeaeae";g2.symbol.linkcolor="#666";g2.symbol.linkfill="rgba(225,225,225,0.75)";g2.symbol.dimcolor="darkslategray";g2.symbol.solid=[];g2.symbol.dash=[15,10];g2.symbol.dot=[4,4];g2.symbol.dashdot=[25,6.5,2,6.5];g2.symbol.labelSignificantDigits=3;g2.canvasHdl=function(t){if(this instanceof g2.canvasHdl){if(t instanceof CanvasRenderingContext2D){this.ctx=t;this.cur=g2.defaultStyle;this.stack=[this.cur];this.matrix=[[1,0,0,1,.5,.5]];this.gridBase=2;this.gridExp=1;return this}else return null}return g2.canvasHdl.apply(Object.create(g2.canvasHdl.prototype),arguments)};g2.handler.factory.push(t=>t instanceof g2.canvasHdl?t:t instanceof CanvasRenderingContext2D?g2.canvasHdl(t):false);g2.canvasHdl.prototype={init(t,e){this.stack.length=1;this.matrix.length=1;this.initStyle(e?Object.assign({},this.cur,e):this.cur);return true},view({x:t=0,y:e=0,scl:s=1,cartesian:i=false}){this.pushTrf(i?[s,0,0,-s,t,this.ctx.canvas.height-1-e]:[s,0,0,s,t,e])},grid({color:t="#ccc",size:e}={}){const s=this.ctx,i=s.canvas.width,n=s.canvas.height,{x:r,y:o,scl:a}=this.uniTrf,l=e||this.gridSize(a),c=r%l,h=o%l;s.save();s.setTransform(1,0,0,1,0,0);s.strokeStyle=t;s.lineWidth=1;s.beginPath();for(let t=c,e=i+1;t<e;t+=l){s.moveTo(t,0);s.lineTo(t,n)}for(let t=h,e=n+1;t<e;t+=l){s.moveTo(0,t);s.lineTo(i,t)}s.stroke();s.restore()},clr({b:t,h:e}={}){const s=this.ctx;s.save();s.setTransform(1,0,0,1,0,0);s.clearRect(0,0,t||s.canvas.width,e||s.canvas.height);s.restore()},cir({r:t}){const{x:e=0,y:s=0}=arguments[0];this.ctx.beginPath();this.ctx.arc(e||0,s||0,Math.abs(t),0,2*Math.PI,true);this.drw(arguments[0])},arc({r:t,w:e=0,dw:s=2*Math.PI}){const{x:i=0,y:n=0}=arguments[0];if(Math.abs(s)>Number.EPSILON&&Math.abs(t)>Number.EPSILON){this.ctx.beginPath();this.ctx.arc(i,n,Math.abs(t),e,e+s,s<0)}else if(Math.abs(s)<Number.EPSILON&&Math.abs(t)>Number.EPSILON){const r=Math.cos(e),o=Math.sin(e);this.ctx.beginPath();this.ctx.moveTo(i-t*r,n-t*o);this.ctx.lineTo(i+t*r,n+t*o)}this.drw(arguments[0])},ell({rx:t,ry:e,w:s=0,dw:i=2*Math.PI,rot:n=0}){const{x:r=0,y:o=0}=arguments[0];this.ctx.beginPath();this.ctx.ellipse(r,o,Math.abs(t),Math.abs(e),n,s,s+i,i<0);this.drw(arguments[0])},box({x:t=0,y:e=0,w:s=0,b:i,h:n}){if(s===0)this.rec({...arguments[0],x:t-i/2,y:e-n/2});else{const r=this.setStyle(arguments[0]);const[o,a]=[Math.cos(s),Math.sin(s)];this.ctx.save();this.ctx.transform(o,a,-a,o,t,e);this.ctx.fillRect(-i/2,-n/2,i,n);this.ctx.strokeRect(-i/2,-n/2,i,n);this.ctx.restore();this.resetStyle(r)}},rec({b:t,h:e}){const{x:s=0,y:i=0}=arguments[0].p!==undefined?arguments[0].p:arguments[0];const n=this.setStyle(arguments[0]);this.ctx.fillRect(s,i,t,e);this.ctx.strokeRect(s,i,t,e);this.resetStyle(n)},lin(t){this.ctx.beginPath();this.ctx.moveTo(t.x1||0,t.y1||0);this.ctx.lineTo(t.x2||0,t.y2||0);this.stroke(t)},ply(t){const e=t.pts;const s=e.length;let i=e[0];this.ctx.beginPath();this.ctx.moveTo(i.x,i.y);for(let t=1;t<s;t++)this.ctx.lineTo((i=e[t]).x,i.y);if(t.closed)this.ctx.closePath();this.drw(t);return s},txt({str:t,w:e=0}){const{x:s=0,y:i=0}=arguments[0].p!==undefined?arguments[0].p:arguments[0];const n=this.setStyle(arguments[0]);const r=e?Math.sin(e):0,o=e?Math.cos(e):1;const a=this.isCartesian?[o,r,r,-o,s,i]:[o,r,-r,o,s,i];this.setTrf(a);if(this.ctx.fillStyle==="rgba(0, 0, 0, 0)"){this.ctx.fillStyle=this.ctx.strokeStyle;n.fs="transparent"}this.ctx.fillText(t,0,0);this.resetTrf();this.resetStyle(n)},errorImageStr:"data:image/gif;base64,R0lGODlhHgAeAKIAAAAAmWZmmZnM/////8zMzGZmZgAAAAAAACwAAAAAHgAeAEADimi63P5ryAmEqHfqPRWfRQF+nEeeqImum0oJQxUThGaQ7hSs95ezvB4Q+BvihBSAclk6fgKiAkE0kE6RNqwkUBtMa1OpVlI0lsbmFjrdWbMH5Tdcu6wbf7J8YM9H4y0YAE0+dHVKIV0Efm5VGiEpY1A0UVMSBYtPGl1eNZhnEBGEck6jZ6WfoKmgCQA7",images:Object.create(null),async loadImage(t){const e=async r=>{const t=new Promise((t,e)=>{let s=new Image;s.src=r;function i(t){s.removeEventListener("load",n);s=undefined;e(t)}function n(){s.removeEventListener("error",i);t(s);s=undefined}s.addEventListener("error",i,{once:true});s.addEventListener("load",n,{once:true})});try{return await t}catch(t){if(r===this.errorImageStr){throw t}else{return await e(this.errorImageStr)}}};let s=this.images[t];if(s!==undefined){return s instanceof Promise?await s:s}s=e(t);this.images[t]=s;try{s=await s}finally{this.images[t]=s}return s},async img({uri:t,x:e=0,y:s=0,b:i,h:n,sx:r=0,sy:o=0,sb:a,sh:l,xoff:c=0,yoff:h=0,w:y=0,scl:f=1}){const g=await this.loadImage(t);this.ctx.save();const d=this.isCartesian?-1:1;a=a||g.width;i=i||g.width;l=l||g.height;n=(n||g.height)*d;h*=d;y*=d;s=this.isCartesian?-(s/f)+o:s/f;const[x,p]=[Math.cos(y),Math.sin(y)];this.ctx.scale(f,f*d);this.ctx.transform(x,p,-p,x,e/f,s);this.ctx.drawImage(g,r,o,a,l,c,h,i,n);this.ctx.restore()},beg({w:t=0,scl:e=1,matrix:s}={}){const{x:i=0,y:n=0}=arguments[0].p!==undefined?arguments[0].p:arguments[0];let r=s;if(!r){const o=t?Math.sin(t)*e:0;const a=t?Math.cos(t)*e:e;r=[a,o,-o,a,i,n]}this.pushTrf(r);this.pushStyle(arguments[0])},end(){this.popStyle();this.popTrf()},path(t){const c=this.ctx;const e=this.setStyle(t);const{w:s=0,x:i=0,y:n=0}=t;const r=s||i||n;if(r){const o=s?Math.sin(s):0;const a=s?Math.cos(s):1;this.pushTrf([a,o,-o,a,i,n])}if(t.seg){const h=t.seg,y=h.length;let l;const f={m(){c.moveTo(h[l].x,h[l].y);l++},l(){c.lineTo(h[l].x,h[l].y);l++},q(){c.quadraticCurveTo(h[l].x,h[l].y,h[l+1].x,h[l+1].y);l+=2},c(){c.bezierCurveTo(h[l].x,h[l].y,h[l+1].x,h[l+1].y,h[l+2].x,h[l+2].y);l+=3},a(){const e=h[l].dw,t=Math.abs(e);const s=t>Number.EPSILON&&t<2*Math.PI?1/Math.tan(e/2):0;if(l>0&&s!==0){const i=h[l].x-h[l-1].x,n=h[l].y-h[l-1].y;const r=(i-s*n)/2,o=(n+s*i)/2;const a=Math.hypot(r,o);const t=Math.atan2(-o,-r);c.ellipse(h[l-1].x+r,h[l-1].y+o,a,a,0,t,t+e,e<0)}else c.lineTo(h[l].x,h[l].y);l++},z(){c.closePath();l++}};c.beginPath();for(l=0;l<y;)f[h[l].c||"l"]();c.fill();if(c.shadowColor!=="rgba(0, 0, 0, 0)"&&c.fillStyle!=="rgba(0, 0, 0, 0)"){const g=c.shadowColor;c.shadowColor="rgba(0, 0, 0, 0)";c.stroke();c.shadowColor=g}else c.stroke()}else if(t.d){const l=new Path2D(t.d);c.fill(l);if(c.shadowColor!=="rgba(0, 0, 0, 0)"&&c.fillStyle!=="rgba(0, 0, 0, 0)"){const g=c.shadowColor;c.shadowColor="rgba(0, 0, 0, 0)";c.stroke(l);c.shadowColor=g}else c.stroke(l)}if(r)this.popTrf();this.resetStyle(e)},stroke({d:t}={}){let e=this.setStyle(arguments[0]);t?this.ctx.stroke(new Path2D(t)):this.ctx.stroke();this.resetStyle(e)},fill({d:t}={}){let e=this.setStyle(arguments[0]);t?this.ctx.fill(new Path2D(t)):this.ctx.fill();this.resetStyle(e)},drw({d:e,lsh:t}={}){let s=this.ctx,i=this.setStyle(arguments[0]),n=e&&new Path2D(e);e?s.fill(n):s.fill();if(s.shadowColor!=="rgba(0, 0, 0, 0)"&&s.fillStyle!=="rgba(0, 0, 0, 0)"&&!t){let t=s.shadowColor;s.shadowColor="rgba(0, 0, 0, 0)";e?s.stroke(n):s.stroke();s.shadowColor=t}else e?s.stroke(n):s.stroke();this.resetStyle(i)},get:{fs:t=>t.fillStyle,ls:t=>t.strokeStyle,lw:t=>t.lineWidth,lc:t=>t.lineCap,lj:t=>t.lineJoin,ld:t=>t.getLineDash(),ldoff:t=>t.lineDashOffset,ml:t=>t.miterLimit,sh:t=>[t.shadowOffsetX||0,t.shadowOffsetY||0,t.shadowBlur||0,t.shadowColor||"black"],font:t=>t.font,thal:t=>t.textAlign,tval:t=>t.textBaseline},set:{fs:(t,e)=>{t.fillStyle=e},ls:(t,e)=>{t.strokeStyle=e},lw:(t,e)=>{t.lineWidth=e},lc:(t,e)=>{t.lineCap=e},lj:(t,e)=>{t.lineJoin=e},ld:(t,e)=>{t.setLineDash(e)},ldoff:(t,e)=>{t.lineDashOffset=e},ml:(t,e)=>{t.miterLimit=e},sh:(t,e)=>{if(e){t.shadowOffsetX=e[0]||0;t.shadowOffsetY=e[1]||0;t.shadowBlur=e[2]||0;t.shadowColor=e[3]||"black"}},font:(t,e)=>{t.font=e},thal:(t,e)=>{t.textAlign=e},tval:(t,e)=>{t.textBaseline=e}},initStyle(t){for(const e in t)if(this.get[e]&&this.get[e](this.ctx)!==t[e])this.set[e](this.ctx,t[e])},setStyle(e){let s,i={};for(const n in e){if(this.get[n]){let t=e[n];if(typeof e[n]==="string"&&e[n][0]==="@"){const r=e[n].substr(1);t=g2.symbol[r]||r in this.get&&this.get[r](this.ctx)||r in this.cur&&this.cur[r]}if((s=this.get[n](this.ctx))!==t){i[n]=s;this.set[n](this.ctx,t)}}}return i},resetStyle(t){for(const e in t)this.set[e](this.ctx,t[e])},pushStyle(e){let t={};for(const s in e)if(g2.styleRex.test(s)){if(typeof e[s]==="string"&&e[s][0]==="@"){let t=e[s].substr(1);e[s]=g2.symbol[t]||this.get[t]&&this.get[t](this.ctx)}if(this.cur[s]!==e[s]){if(s in this.set)this.set[s](this.ctx,e[s]);t[s]=e[s]}}this.stack.push(this.cur=Object.assign({},this.cur,t))},popStyle(){let t=this.stack.pop();this.cur=this.stack[this.stack.length-1];for(const e in this.cur)if(this.get[e]&&this.cur[e]!==t[e])this.set[e](this.ctx,this.cur[e])},concatTrf(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},initTrf(){this.ctx.setTransform(...this.matrix[0])},setTrf(t){this.ctx.setTransform(...this.concatTrf(this.matrix[this.matrix.length-1],t))},resetTrf(){this.ctx.setTransform(...this.matrix[this.matrix.length-1])},pushTrf(t){let e=this.concatTrf(this.matrix[this.matrix.length-1],t);this.matrix.push(e);this.ctx.setTransform(...e)},popTrf(){this.matrix.pop();this.ctx.setTransform(...this.matrix[this.matrix.length-1])},get isCartesian(){let t=this.matrix[this.matrix.length-1];return t[0]*t[3]-t[1]*t[2]<0},get uniTrf(){let t=this.matrix[this.matrix.length-1];return{x:t[4],y:t[5],scl:Math.hypot(t[0],t[1]),cartesian:t[0]*t[3]-t[1]*t[2]<0}},unscaleTrf({x:t,y:e}){let s=this.matrix[this.matrix.length-1],i=1/Math.hypot(s[0],s[1]);return[i,0,0,i,(1-i)*t,(1-i)*e]},gridSize(t){let e=this.gridBase,s=this.gridExp,i;while((i=t*e*Math.pow(10,s))<14||i>35){if(i<14){if(e==1)e=2;else if(e==2)e=5;else if(e==5){e=1;s++}}else{if(e==1){e=5;s--}else if(e==2)e=1;else if(e==5)e=2}}this.gridBase=e;this.gridExp=s;return i},p(){this.ctx.beginPath()},z(){this.ctx.closePath()},m({x:t,y:e}){this.ctx.moveTo(t,e)},l({x:t,y:e}){this.ctx.lineTo(t,e)},q({x:t,y:e,x1:s,y1:i}){this.ctx.quadraticCurveTo(s,i,t,e)},c({x:t,y:e,x1:s,y1:i,x2:n,y2:r}){this.ctx.bezierCurveTo(s,i,n,r,t,e)},a({dw:p,k:u,phi:m,_xp:b,_yp:w}){const{x:v=0,y:M=0}=arguments[0].p!==undefined?arguments[0].p:arguments[0];if(u===undefined)u=1;if(Math.abs(p)>Number.EPSILON){if(u===1){let t=v-b,e=M-w;let s=Math.tan(p/2),i=(t-e/s)/2,n=(e+t/s)/2,r=Math.hypot(i,n),o=Math.atan2(-n,-i);this.ctx.ellipse(b+i,w+n,r,r,0,o,o+p,this.cartesian?p>0:p<0)}else{if(m===undefined)m=0;let t=p>0?b:v,e=p>0?w:M,s=p>0?v:b,i=p>0?M:w;let n=s-t,r=i-e,o=p<0?p:-p;let a=m?Math.cos(m):1,l=m?Math.sin(m):0,c=-n*a-r*l,h=-n*l-r*a,y=Math.sin(o/2),f=Math.sqrt((c*c+h*h/(u*u))/(4*y*y)),g=Math.atan2(u*c,h)-o/2,d=t-f*Math.cos(g),x=e-f*u*Math.sin(g);this.ctx.ellipse(d,x,f,f*u,m,g,g+p,this.cartesian?p>0:p<0)}}else this.ctx.lineTo(v,M)}}
/**
 * g2.selectorHdl.js (c) 2018-22 Stefan Goessner
 * @file selector for `g2` elements.
 * @author Stefan Goessner
 * @license MIT License
 */;var g2=g2||{prototype:{}};g2.selectorHdl=function(t){if(this instanceof g2.selectorHdl){this.selection=false;this.evt=t;return this}return g2.selectorHdl.apply(Object.create(g2.selectorHdl.prototype),arguments)};g2.handler.factory.push(t=>t instanceof g2.selectorHdl?t:false);g2.selectorHdl.prototype={init(t){return true},exe(s){for(let t=false,e=s.length;e&&!t;e--)t=this.hit(s[e-1].a)},selectable(t){return t&&t.draggable&&t.hit},hit(t){if(!this.evt.inside||!this.selectable(t))return false;if(!t.state&&this.elementHit(t)&&t.draggable){if(!this.selection||this.selection&&!(this.selection.state&g2.DRAG)){if(this.selection)this.selection.state^=g2.OVER;this.selection=t;t.state=g2.OVER;this.evt.hit=true}}else if(t.state&g2.DRAG){if(!this.evt.btn)this.elementDragEnd(t)}else if(t.state&g2.OVER){if(!this.elementHit(t)){t.state^=g2.OVER;this.evt.hit=false;this.selection=false}else if(this.evt.btn)this.elementDragBeg(t)}return t.state&&t},elementDragBeg(t){t.state|=g2.DRAG;if(t.dragBeg)t.dragBeg(e)},elementDragEnd(t){t.state^=g2.OVER|g2.DRAG;this.selection=false;if(t.dragEnd)t.dragEnd(e)},elementHit(t){return t.hit&&t.hit({x:this.evt.xusr,y:this.evt.yusr,eps:this.evt.eps})}};
/**
 * canvasInteractor.js (c) 2018-22 Stefan Goessner
 * @file interaction manager for html `canvas`.
 * @author Stefan Goessner
 * @license MIT License
 */globalThis.canvasInteractor=globalThis.canvasInteractor||{create(){const t=Object.create(this.prototype);t.constructor.apply(t,arguments);return t},fps:"?",fpsOrigin:0,frames:0,rafid:0,instances:[],tick(t){canvasInteractor.fpsCount(t);for(const e of canvasInteractor.instances){e.notify("tick",{t:t,dt:(t-e.t)/1e3,dirty:e.dirty});e.t=t;e.dirty=false}canvasInteractor.rafid=requestAnimationFrame(canvasInteractor.tick)},add(t){canvasInteractor.instances.push(t);if(canvasInteractor.instances.length===1)canvasInteractor.tick(canvasInteractor.fpsOrigin=performance.now())},remove(t){canvasInteractor.instances.splice(canvasInteractor.instances.indexOf(t),1);if(canvasInteractor.instances.length===0)cancelAnimationFrame(canvasInteractor.rafid)},fpsCount(t){if(t-canvasInteractor.fpsOrigin>1e3){const e=~~(canvasInteractor.frames*1e3/(t-canvasInteractor.fpsOrigin)+.5);if(e!==canvasInteractor.fps)for(const s of canvasInteractor.instances)s.notify("fps",canvasInteractor.fps=e);canvasInteractor.fpsOrigin=t;canvasInteractor.frames=0}canvasInteractor.frames++},prototype:{constructor(t,{x:e=0,y:s=0,scl:i=1,cartesian:n=false}){this.ctx=t;this.view={x:e,y:s,scl:i,cartesian:n};this.evt={type:false,x:-2,y:-2,xi:0,yi:0,dx:0,dy:0,btn:0,xbtn:0,ybtn:0,xusr:-2,yusr:-2,dxusr:0,dyusr:0,delta:0,inside:false,hit:false,dscl:1,eps:5};this.dirty=true;const r=t.canvas;r.addEventListener("pointermove",this,false);r.addEventListener("pointerdown",this,false);r.addEventListener("pointerup",this,false);r.addEventListener("pointerenter",this,false);r.addEventListener("pointerleave",this,false);r.addEventListener("wheel",this,false);r.addEventListener("pointercancel",this,false);this.signals={}},deinit(){const t=this.ctx.canvas;t.removeEventListener("pointermove",this,false);t.removeEventListener("pointerdown",this,false);t.removeEventListener("pointerup",this,false);t.removeEventListener("pointerenter",this,false);t.removeEventListener("pointerleave",this,false);t.removeEventListener("wheel",this,false);t.removeEventListener("pointercancel",this,false);this.endTimer();delete this.signals;delete this.evt;delete this.ctx;return this},handleEvent(t){if(t.type in this&&(t.isPrimary||t.type==="wheel")){const e=t.target.getBoundingClientRect&&t.target.getBoundingClientRect()||{left:0,top:0},s=t.clientX-Math.floor(e.left),i=t.clientY-Math.floor(e.top),n=t.buttons!==undefined?t.buttons:t.button||t.which;this.evt.type=t.type;this.evt.xi=this.evt.x;this.evt.yi=this.evt.y;this.evt.dx=this.evt.dy=0;this.evt.x=s;this.evt.y=this.view.cartesian?this.ctx.canvas.height-i:i;this.evt.xusr=(this.evt.x-this.view.x)/this.view.scl;this.evt.yusr=(this.evt.y-this.view.y)/this.view.scl;this.evt.dxusr=this.evt.dyusr=0;this.evt.dbtn=n-this.evt.btn;this.evt.btn=n;this.evt.delta=Math.max(-1,Math.min(1,t.deltaY||t.wheelDelta))||0;if(this.isDefaultPreventer(t.type))t.preventDefault();this[t.type]();this.notify(this.evt.type,this.evt)}else console.log(t)},pointermove(){this.evt.dx=this.evt.x-this.evt.xi;this.evt.dy=this.evt.y-this.evt.yi;if(this.evt.btn===1){this.evt.dxusr=this.evt.dx/this.view.scl;this.evt.dyusr=this.evt.dy/this.view.scl;this.evt.xusr-=this.evt.dxusr;this.evt.yusr-=this.evt.dyusr;if(!this.evt.hit){this.evt.type="pan"}else this.evt.type="drag"}this.dirty=true},pointerdown(){this.evt.xbtn=this.evt.x;this.evt.ybtn=this.evt.y},pointerup(){this.evt.type=this.evt.x===this.evt.xbtn&&this.evt.y===this.evt.ybtn?"click":"pointerup";this.evt.xbtn=this.evt.x;this.evt.ybtn=this.evt.y;this.evt.hit=false},pointerleave(){this.evt.inside=false},pointerenter(){this.evt.inside=true},wheel(){this.evt.dscl=this.evt.delta>0?8/10:10/8;this.evt.eps/=this.evt.dscl;this.dirty=true},isDefaultPreventer(t){return["pointermove","pointerdown","pointerup","wheel"].includes(t)},pntToUsr:function(t){let e=this.view;t.x=(t.x-e.x)/e.scl;t.y=(t.y-e.y)/e.scl;return t},startTimer(){canvasInteractor.add(this);this.notify("timerstart",this);return this},endTimer(){this.notify("timerend",this.t/1e3);canvasInteractor.remove(this);return this},notify(e,s){if(this.signals[e])for(let t of this.signals[e])t(s);return this},on(e,s){if(Array.isArray(e))for(let t of e)this.on(t,s);else(this.signals[e]||(this.signals[e]=[])).push(s);return this},remove(t,e){const s=this.signals[t]?this.signals[t].indexOf(e):-1;if(s>=0)this.signals[t].splice(s,1)}}};"use strict";
/**
 * @author Pascal Schnabel
 * @license MIT License
 * @requires g2.core.js
 * @requires g2.ext.js
 */g2.symbol=g2.symbol||{};g2.symbol.poldot=g2().cir({x:0,y:0,r:1.32,ls:"transparent",fs:"black"});g2.symbol.nodfill3="white";g2.symbol.pol=g2().cir({x:0,y:0,r:6,ls:"black",lw:1.5,fs:"white"}).use({grp:"poldot"});g2.symbol.Xcross=g2().lin({x1:5,y1:5,x2:-5,y2:-5}).lin({x1:5,y1:-5,x2:-5,y2:5});g2.symbol.gndlines=g2().lin({x1:-10,y1:-5,x2:-5,y2:0}).lin({x1:-5,y1:-5,x2:-0,y2:0}).lin({x1:-0,y1:-5,x2:5,y2:0}).lin({x1:5,y1:-5,x2:10,y2:0});g2.symbol.nodfix2=function(){const t=9,s=12;const i=g2().p().m({x:3,y:2}).l({x:-3,y:2}).l({x:-t,y:-s}).l({x:t,y:-s}).l({x:3,y:2}).z().stroke({ls:"black",lw:1.1,fs:"white"});const n=t*2/3;for(let e=-t+2;e<t+5;e+=n){let t=6;i.lin({x1:e,y1:-s,x2:e-t,y2:-s-t})}i.lin({x1:-t-3,y1:-s,x2:t+3,y2:-s});i.use({grp:"pol"});i.end();return i};g2.symbol.slider=function(){const t=g2();const e={b:32,h:16,fs:"white",lw:.8,label:{str:"default",loc:"ne",off:"15"}};return g2().rec({x:-e.b/2,y:-e.h/2,b:e.b,h:e.h,fs:"white"}).use({grp:"pol"}).end()};"use strict";
/**
 * @author Pascal Schnabel
 * @license MIT License
 * @requires g2.core.js
 * @requires g2.ext.js
 * @typedef {g2}
 * @description Mechanical extensions. (Requires cartesian coordinates)
 * @returns {g2}
 */g2.symbol.nodfill3="white";var g2=g2||{prototype:{}};g2.prototype.gndlines=function({x:t,y:e,w:s}){return this.addCommand({c:"gndlines",a:arguments[0]})};g2.prototype.gndlines.prototype={x:0,y:0,w:0,ds:[8,13],anz:4,g2(t){const{x:r,y:o,w:a,ls:l=g2.symbol.nodcolor,fs:e=g2.symbol.nodfill,lw:c=2,ds:s,anz:i}=this;const h=s[0];const y=s[1];const f=a-Math.PI/4*3;const g=g2();for(let n=0;n<i;n+=1){let t=r+n*h*Math.cos(a);let e=o+n*h*Math.sin(a);let s=t+y*Math.cos(f);let i=e+y*Math.sin(f);g.lin({x1:t,y1:e,x2:s,y2:i,ls:l,lw:c})}g.end();return g}};g2.prototype.nodfix2=function({x:t,y:e,w:s,scl:i}){return this.addCommand({c:"nodfix2",a:arguments[0]})};g2.prototype.nodfix2.prototype=g2.mixin(g2.ifc.point,g2.ifc.circular,g2.ifc.label,{x:0,y:0,w:0,scl:1,lbloc:"e",lboff:4,width:9,h:12,g2(t){const{x:e,y:s,w:i,h:n,scl:r,width:o,ls:a=g2.symbol.nodcolor,fs:l=g2.symbol.nodfill3,fs_2:c="#fefefe99"}=this;let h=g2().beg({x:e,y:s,scl:r,w:i}).lin({x1:-o-5,y1:-n,x2:o+5,y2:-n}).path({seg:[{c:"m",x:-3,y:2},{c:"l",x:-o,y:-n},{c:"l",x:o,y:-n},{c:"l",x:3,y:2},{c:"l",x:-3,y:2},{c:"z"}],ls:a,fs:l}).use({grp:"pol",x:0,y:0,scl:1});let y=o*2/3;for(let e=-o+2;e<o+5;e+=y){let t=6;h.lin({x1:e,y1:-n,x2:e-t,y2:-n-t})}h.end();return h}});g2.prototype.gndline=function({x1:t,x2:e,y1:s,y2:i,typ:n,ls:r}){return this.addCommand({c:"gndline",a:arguments[0]})};g2.prototype.gndline.prototype=g2.mixin(g2.ifc.line,{x1:0,y1:0,x2:100,y2:100,ls:"black",g2(t){const{x1:r,y1:o,x2:e,y2:s,lw:a=2,ls:l=g2.symbol.nodcolor,typ:i="out",anz:n=4,ds:c=[5,12]}=this;const h={x:e-r,y:s-o};const y=Math.atan2(h.y,h.x);const f=Math.sqrt(h.x*h.x+h.y*h.y);const g=g2();let d,x,p;switch(i){case"mid":d=(f-8*(n+1)/2-f/2)/f;x={x:r+Math.cos(y)*f*d,y:o+Math.sin(y)*f*d};g.gndlines({x:x.x,y:x.y,w:y,ls:l,lw:a,anz:n});break;case"out":d=(f-8*(n+1)/2-f/2)/f;x={x:r+Math.cos(y)*c[0]*(n-2),y:o+Math.sin(y)*c[0]*(n-2)};p={x:e-Math.cos(y)*c[0]*n,y:s-Math.sin(y)*c[0]*n};g.gndlines({x:x.x,y:x.y,w:y,ls:l,lw:a,anz:n,ds:c});g.gndlines({x:p.x,y:p.y,w:y,ls:l,lw:a,anz:n,ds:c});break;case"full":const u=c[0];const m=c[1];const b=y-Math.PI/4*3;let t=f/u-2;for(let n=0;n<t;n+=1){let t=r+(n*u+u)*Math.cos(y);let e=o+(n*u+u)*Math.sin(y);let s=t+m*Math.cos(b);let i=e+m*Math.sin(b);g.lin({x1:t,y1:e,x2:s,y2:i,ls:l,lw:a})}break;default:d=4*3/f;x={x:r+Math.cos(y)*f*d,y:o+Math.sin(y)*f*d};const w=(f-6*5)/f;p={x:r+Math.cos(y)*f*w,y:o+Math.sin(y)*f*w};g.gndlines({x:x.x,y:x.y,w:y,ls:l,lw:a});g.gndlines({x:p.x,y:p.y,w:y,ls:l,lw:a});break}return g.lin({x1:r,y1:o,x2:e,y2:s,lw:a*2,label:this.label===undefined?"":this.label})}});g2.prototype.guide=function({x1:t,x2:e,y1:s,y2:i,w:n,ls:r}){return this.addCommand({c:"guide",a:arguments[0]})};g2.prototype.guide.prototype=g2.mixin(g2.ifc.line,g2.ifc.label,{lbloc:"w",lboff:4,g2(t){const{x1:e,y1:s,x2:i,y2:n,lw:r=1,ls:o=g2.symbol.nodcolor,anz:a=4,ds:l=[5,10]}=this;let c,h,y,f;if(this.w===undefined){h={x:i-e,y:n-s};y=Math.atan2(h.y,h.x)}else{f=Object.getOwnPropertyDescriptor(this,"len")?this.len:100;y=this.w;h={x:f*Math.cos(y),y:Math.sin(y)*f};const b=Math.atan2(h.y,h.x)}const g=Object.getOwnPropertyDescriptor(this,"width")?this.width:24;const d={x:e-Math.sin(y)*g/2,y:s+Math.cos(y)*g/2};const x={x:d.x+h.x,y:d.y+h.y};const p={x:e+Math.sin(y)*g/2,y:s-Math.cos(y)*g/2};const u={x:p.x+h.x,y:p.y+h.y};const m=g2().beg({ls:o}).gndline({x1:x.x,y1:x.y,x2:d.x,y2:d.y,lw:r,ds:l,anz:a,typ:"out"}).gndline({x1:p.x,y1:p.y,x2:u.x,y2:u.y,lw:r,ds:l,anz:a,typ:"out"}).end();return m}});g2.prototype.Ecke=function({p1:t,p2:e,p3:s,w:i,ls:n}){return this.addCommand({c:"Ecke",a:arguments[0]})};g2.prototype.Ecke.prototype=g2.mixin(g2.ifc.label,{lbloc:"e",lboff:2,g2(t){const{p1:e,p2:s,p3:i,ls:n="black",size:r=45,side:o=1,fs:a="transparent"}=this;const l=Math.atan2(e.y-s.y,e.x-s.x);const c=Math.atan2(i.y-s.y,i.x-s.x);let h=c-l;if(o<1)h=2*Math.PI-h;const y=g2().beg({x:s.x,y:s.y,w:Math.atan2(e.y-s.y,e.x-s.x)});y.p().m({x:r,y:0}).q({x1:0,y1:0,x:r*Math.cos(h*o),y:r*Math.sin(h*o)}).l({x:0,y:0}).l({x:r,y:0}).z().fill({fs:a,ls:n});y.end();return y}});g2.prototype.corner=function({p1:t,p2:e,p:s,w:i,ls:n,r}){return this.addCommand({c:"corner",a:arguments[0]})};g2.prototype.corner.prototype={lbloc:"e",lboff:2,g2(t){const{p1:e,p2:s,p:i,lw:n=1,ls:r=g2.symbol.nodcolor,anz:o=4,size:a=20,fs:l="black",side:c=1,r:h=20}=this;const y=this.wref1===undefined?Math.atan2(-e.x+i.x,-e.y+i.y):this.wref1.w;const f=this.wref2===undefined?Math.atan2(-s.x+i.x,-s.y+i.y):this.wref2.w;let g=(f-y+Math.PI*2)%Math.PI;if(this.side<1){g=-g}console.log(`dw:${g*180/Math.PI}`);const d={x:i.x+-Math.cos(y)*h,y:-Math.sin(y)*h+i.y};const x={x:i.x+Math.cos(f)*h,y:Math.sin(f)*h+i.y};const p=g2();p.p().m({x:i.x,y:i.y}).l({x:d.x,y:d.y}).a({dw:(f-y)*c,x:x.x,y:x.y}).l({x:i.x,y:i.y}).z().stroke();p.cir({x:d.x,y:d.y,r:5,ls:"red"});p.cir({x:x.x,y:x.y,r:5,ls:"green"});return p}};